<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>회원 가입</title>
    <script src="http://code.jquery.com/jquery-latest.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
</head>

<body>
    <h1>회원 가입 완료되었습니다.</h1>
    <a href="#" onclick="memberLoad()">회원목록보기</a>
    <a href="#" onclick="memberLoad2()">(부트스트랩)회원목록보기</a>
    <div id="content"></div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
        crossorigin="anonymous"></script>

    <script>
        function memberLoad() {
            $('#content').empty();
            $.ajax({
                url: '/students',
                type: 'get',
                // dataType:'JSON',
                success: function(data) {
                    var out = "";
                    $(data).each((i,item)=>{
                        // console.log(i,item);
                        out += "<ol>";
                        out += `<li>id : ${item.id} <button id=${item.id}>삭제</button> </li>`;
                        out += `<li>name : ${item.name} </li>`;
                        out += `<li>password : ${item.password} </li>`;
                        out += `<li>email : ${item.email} </li>`;
                        out += `<li>gender : ${item.gender} </li>`;
                        out += "</ol>";
                    })
                    $(out).appendTo('#content');
                }
            })
        }

        function memberLoad2() {
            $('#content').empty();
            $.ajax({
                url: '/students',
                type: 'get',
                // dataType:'JSON',
                success: function(data) {
                    var out = "<div class='container'>";
                    $(data).each((i,item)=>{
                        // console.log(i,item);
                        out += "<ol class='list-group mt-3'>";
                        out += `<li class='list-group-item active'>id : ${item.id} <button id=${item.id}>삭제</button></li>`;
                        out += `<li class='list-group-item'>name : ${item.name} </li>`;
                        out += `<li class='list-group-item'>password : ${item.password} </li>`;
                        out += `<li class='list-group-item'>email : ${item.email} </li>`;
                        out += `<li class='list-group-item'>gender : ${item.gender} </li>`;
                        out += "</ol>";
                    })
                    out += "</div>";
                    $(out).appendTo('#content');
                }
            })
        }

        //삭제버튼 클릭해서 서버에 삭제 요청하기
        $(document).on('click','button',function(e){
            // var id = $(this).context.id
            var id = e.currentTarget.id;
            // var id = e.srcElement.id;
            console.log(id);
            $.ajax({
                url:'/students/'+id,
                type:'delete',
                success:function(data){
                    memberLoad();   // 전체목록보기
                }
            })

        });
        
        
    </script>

</body>

</html>